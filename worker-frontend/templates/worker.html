<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Stock Management Dashboard | Smart Trolley</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#0d59f2",
                        "background-light": "#f5f6f8",
                        "background-dark": "#101622",
                        "panel-dark": "#161c2b",
                        "border-dark": "#282e39",
                    },
                    fontFamily: {
                        "display": ["Inter"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                },
            },
        }
    </script>
    <style>
        .glass-card {
            background: rgba(40, 46, 57, 0.4);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        .glass-panel {
            background: rgba(22, 28, 43, 0.8);
            backdrop-filter: blur(12px);
        }

        .canvas-bg {
            background-color: #e2e8f0;
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* Transition for mode switching */
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display text-white overflow-hidden h-screen flex flex-col">

    <!-- TOP NAVIGATION (SHARED) -->
    <header
        class="flex items-center justify-between whitespace-nowrap border-b border-solid border-[#282e39] bg-background-dark px-6 py-3 sticky top-0 z-50">
        <div class="flex items-center gap-8">
            <div class="flex items-center gap-4 text-white">
                <div class="flex items-center justify-center size-8 bg-primary rounded-lg">
                    <span class="material-symbols-outlined text-white text-xl">shopping_cart</span>
                </div>
                <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">Smart Trolley</h2>
            </div>

            <!-- Global Search (Stock Mode Only) -->
            <label class="flex flex-col min-w-40 !h-10 max-w-64 hidden" id="global-search">
                <div class="flex w-full flex-1 items-stretch rounded-lg h-full">
                    <div
                        class="text-[#9ca6ba] flex border-none bg-[#1b212c] items-center justify-center pl-4 rounded-l-lg">
                        <span class="material-symbols-outlined">search</span>
                    </div>
                    <input id="searchInput"
                        class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-white focus:outline-0 focus:ring-0 border-none bg-[#1b212c] focus:border-none h-full placeholder:text-[#9ca6ba] px-4 rounded-l-none pl-2 text-base font-normal"
                        placeholder="Search Inventory..." value="" />
                </div>
            </label>
        </div>

        <div class="flex flex-1 justify-end gap-6 items-center">

            <!-- Mode Switcher -->
            <div class="flex items-center bg-[#1b212c] rounded-lg p-1 mr-4 border border-[#282e39]">
                <button onclick="setMode('stock')" id="btn-mode-stock"
                    class="px-3 py-1.5 text-xs font-bold rounded-md bg-primary text-white shadow-lg transition-all">Stock
                    Mode</button>
                <button onclick="setMode('design')" id="btn-mode-design"
                    class="px-3 py-1.5 text-xs font-bold rounded-md text-[#9ca6ba] hover:text-white transition-all">Design
                    Mode</button>
            </div>

            <div class="flex items-center gap-3 border-l border-[#282e39] pl-6">
                <div class="text-right">
                    <p class="text-xs text-white font-medium">Worker</p>
                    <p class="text-[10px] text-[#9ca6ba]">Staff #442</p>
                </div>
                <div
                    class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border border-[#3b4354] bg-primary/20 flex items-center justify-center">
                    <span class="material-symbols-outlined text-primary">person</span>
                </div>
            </div>
        </div>
    </header>

    <!-- CONTENT WRAPPER -->
    <div class="flex-1 relative overflow-hidden">

        <!-- ======================= STOCK MODE ======================= -->
        <div id="stock-mode-app" class="absolute inset-0 flex flex-1 fade-in">
            <!-- Sidebar -->
            <aside
                class="w-64 border-r border-[#282e39] bg-background-dark p-4 hidden lg:flex flex-col justify-between">
                <div class="flex flex-col gap-6">
                    <div class="flex gap-3 px-2">
                        <div class="bg-primary/20 flex items-center justify-center rounded-lg size-10">
                            <span class="material-symbols-outlined text-primary">storefront</span>
                        </div>
                        <div class="flex flex-col">
                            <h1 class="text-white text-sm font-medium">Main Store Floor</h1>
                            <p class="text-[#9ca6ba] text-xs">Overview</p>
                        </div>
                    </div>
                    <div class="flex flex-col gap-1">
                        <div onclick="switchStockTab('inventory')" id="nav-inventory"
                            class="flex items-center gap-3 px-4 py-3 rounded-xl bg-primary/10 text-primary cursor-pointer transition-colors">
                            <span class="material-symbols-outlined">inventory_2</span>
                            <p class="text-sm font-bold">Inventory</p>
                        </div>
                        <div onclick="switchStockTab('add-product')" id="nav-add-product"
                            class="flex items-center gap-3 px-4 py-3 rounded-xl text-[#9ca6ba] hover:bg-[#1b212c] hover:text-white cursor-pointer transition-colors">
                            <span class="material-symbols-outlined">add_box</span>
                            <p class="text-sm font-medium">Add Product</p>
                        </div>
                        <div onclick="switchStockTab('settings')" id="nav-settings"
                            class="flex items-center gap-3 px-4 py-3 rounded-xl text-[#9ca6ba] hover:bg-[#1b212c] hover:text-white cursor-pointer transition-colors">
                            <span class="material-symbols-outlined">settings</span>
                            <p class="text-sm font-medium">Settings</p>
                        </div>
                    </div>
                </div>
                <!-- Status -->
                <div class="bg-[#1b212c] p-4 rounded-xl">
                    <p class="text-xs text-[#9ca6ba] mb-2 font-medium">SYSTEM STATUS</p>
                    <div class="flex items-center gap-2">
                        <span class="size-2 bg-green-500 rounded-full"></span>
                        <p class="text-xs text-white">Online</p>
                    </div>
                </div>
            </aside>

            <!-- Main Scrollable Content -->
            <main class="flex-1 overflow-y-auto bg-background-dark p-8">
                <div class="max-w-6xl mx-auto">

                    <!-- Stats Grid (Visible on all stock tabs usually, or just inventory) -->
                    <div id="stats-container" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="flex flex-col gap-2 glass-card rounded-xl p-6">
                            <div class="flex justify-between items-start">
                                <p class="text-[#9ca6ba] text-sm font-medium">Total Products</p>
                                <span class="material-symbols-outlined text-[#9ca6ba]">inventory</span>
                            </div>
                            <p class="text-white text-3xl font-bold" id="statTotal">-</p>
                        </div>
                        <div class="flex flex-col gap-2 glass-card rounded-xl p-6">
                            <div class="flex justify-between items-start">
                                <p class="text-[#9ca6ba] text-sm font-medium">Inventory Value</p>
                                <span class="material-symbols-outlined text-[#9ca6ba]">payments</span>
                            </div>
                            <p class="text-white text-3xl font-bold" id="statValue">-</p>
                        </div>
                        <div class="flex flex-col gap-2 glass-card rounded-xl p-6 border-l-4 border-l-red-500">
                            <div class="flex justify-between items-start">
                                <p class="text-[#9ca6ba] text-sm font-medium">Low Stock Alerts</p>
                                <span class="material-symbols-outlined text-red-500">warning</span>
                            </div>
                            <p class="text-white text-3xl font-bold" id="statLow">-</p>
                        </div>
                    </div>

                    <!-- INVENTORY VIEW -->
                    <section id="inventorySection" class="fade-in">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-white">Inventory List</h2>
                            <div class="flex gap-2">
                                <select id="categoryFilter"
                                    class="bg-[#1b212c] border-none text-white text-sm rounded-lg py-2 px-3">
                                    <option value="all">All Categories</option>
                                </select>
                                <select id="stockFilter"
                                    class="bg-[#1b212c] border-none text-white text-sm rounded-lg py-2 px-3">
                                    <option value="all">Stock Status</option>
                                    <option value="instock">In Stock</option>
                                    <option value="lowstock">Low Stock</option>
                                    <option value="outstock">Out of Stock</option>
                                </select>
                            </div>
                        </div>

                        <div class="bg-[#1b212c] rounded-xl border border-[#282e39] overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                    <thead>
                                        <tr
                                            class="bg-[#212835] text-[#9ca6ba] text-xs uppercase font-bold tracking-wider">
                                            <th class="px-6 py-4">Item</th>
                                            <th class="px-6 py-4">Product</th>
                                            <th class="px-6 py-4">Category</th>
                                            <th class="px-6 py-4">Price</th>
                                            <th class="px-6 py-4">Stock</th>
                                            <th class="px-6 py-4">Unit</th>
                                            <th class="px-6 py-4">Discount</th>
                                            <th class="px-6 py-4">Updated</th>
                                            <th class="px-6 py-4 text-right">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-[#282e39]" id="inventoryTable">
                                        <!-- Rows injected by JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </section>

                    <!-- ADD PRODUCT VIEW -->
                    <section id="addProductSection" class="hidden fade-in">
                        <div class="bg-[#1b212c] rounded-xl border border-[#282e39] p-8 max-w-3xl mx-auto">
                            <h2 class="text-2xl font-bold mb-6 border-b border-[#282e39] pb-4">Add New Item</h2>
                            <form id="addProductForm" class="space-y-6">
                                <div class="grid grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Product ID (Scan
                                            Tag)</label>
                                        <input type="text" name="id"
                                            class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-2 focus:ring-primary focus:border-primary"
                                            placeholder="Scan or type ID..." required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Product
                                            Name</label>
                                        <input type="text" name="name"
                                            class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-2 focus:ring-primary focus:border-primary"
                                            placeholder="e.g. Fresh Milk" required>
                                    </div>
                                </div>
                                <div class="grid grid-cols-3 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Price (â‚¹)</label>
                                        <input type="number" name="price" step="0.01"
                                            class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-2 focus:ring-primary focus:border-primary"
                                            required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Initial
                                            Stock</label>
                                        <input type="number" name="stock"
                                            class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-2 focus:ring-primary focus:border-primary"
                                            value="0">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Unit</label>
                                        <input type="text" name="unit"
                                            class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-2 focus:ring-primary focus:border-primary">
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Discount
                                            (%)</label>
                                        <input type="number" name="discount" min="0" max="90"
                                            class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-2 focus:ring-primary focus:border-primary"
                                            value="0">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Promo
                                            Description</label>
                                        <input type="text" name="promotion_description"
                                            class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-2 focus:ring-primary focus:border-primary">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Expiry Date</label>
                                    <input type="date" name="promotion_expiry"
                                        class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-2 focus:ring-primary focus:border-primary">
                                </div>
                                <div class="grid grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Category</label>
                                        <input type="text" name="category"
                                            class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-2 focus:ring-primary focus:border-primary">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Image URL</label>
                                        <input type="text" name="image"
                                            class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-2 focus:ring-primary focus:border-primary">
                                    </div>
                                </div>
                                <button type="submit"
                                    class="w-full bg-primary hover:bg-blue-600 text-white font-bold py-3 rounded-lg transition-colors">Add
                                    Product to Inventory</button>
                            </form>
                        </div>
                    </section>

                    <!-- SETTINGS VIEW -->
                    <section id="settingsSection" class="hidden fade-in">
                        <div class="bg-[#1b212c] rounded-xl border border-[#282e39] p-8 max-w-4xl mx-auto">
                            <h2 class="text-2xl font-bold mb-6 border-b border-[#282e39] pb-4 flex items-center gap-2">
                                <span class="material-symbols-outlined text-primary">palette</span>
                                UI Customization
                            </h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <!-- Colors -->
                                <div>
                                    <h3 class="text-lg font-bold text-white mb-4">Theme Colors</h3>
                                    <div class="space-y-4">
                                        <div
                                            class="flex items-center justify-between p-3 bg-background-dark rounded-lg border border-[#282e39]">
                                            <span class="text-sm text-[#9ca6ba]">Background</span>
                                            <div class="flex gap-2 items-center">
                                                <input type="color" id="themeBgColor"
                                                    class="bg-transparent border-none size-8 cursor-pointer">
                                                <input type="text" id="themeBgColorText"
                                                    class="w-24 bg-transparent border-none text-right text-xs font-mono text-white">
                                            </div>
                                        </div>
                                        <div
                                            class="flex items-center justify-between p-3 bg-background-dark rounded-lg border border-[#282e39]">
                                            <span class="text-sm text-[#9ca6ba]">Text</span>
                                            <div class="flex gap-2 items-center">
                                                <input type="color" id="themeTextColor"
                                                    class="bg-transparent border-none size-8 cursor-pointer">
                                                <input type="text" id="themeTextColorText"
                                                    class="w-24 bg-transparent border-none text-right text-xs font-mono text-white">
                                            </div>
                                        </div>
                                        <div
                                            class="flex items-center justify-between p-3 bg-background-dark rounded-lg border border-[#282e39]">
                                            <span class="text-sm text-[#9ca6ba]">Navigation</span>
                                            <div class="flex gap-2 items-center">
                                                <input type="color" id="themeNavColor"
                                                    class="bg-transparent border-none size-8 cursor-pointer">
                                                <input type="text" id="themeNavColorText"
                                                    class="w-24 bg-transparent border-none text-right text-xs font-mono text-white">
                                            </div>
                                        </div>
                                        <div
                                            class="flex items-center justify-between p-3 bg-background-dark rounded-lg border border-[#282e39]">
                                            <span class="text-sm text-[#9ca6ba]">Buttons</span>
                                            <div class="flex gap-2 items-center">
                                                <input type="color" id="themeButtonColor"
                                                    class="bg-transparent border-none size-8 cursor-pointer">
                                                <input type="text" id="themeButtonColorText"
                                                    class="w-24 bg-transparent border-none text-right text-xs font-mono text-white">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Banner -->
                                <div>
                                    <h3 class="text-lg font-bold text-white mb-4">Promotional Banner</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Banner
                                                Text</label>
                                            <input type="text" id="promoBannerText"
                                                class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-3 py-2 text-sm"
                                                placeholder="e.g. Summer Sale">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Image
                                                URL</label>
                                            <input type="text" id="promoBannerImage"
                                                class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-3 py-2 text-sm"
                                                placeholder="https://...">
                                        </div>
                                        <div
                                            class="aspect-video bg-background-dark rounded-lg border border-[#282e39] flex items-center justify-center text-[#9ca6ba] text-xs">
                                            Preview
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-8 pt-6 border-t border-[#282e39] flex justify-end">
                                <button onclick="saveSettings()"
                                    class="bg-green-600 hover:bg-green-700 text-white font-bold py-2.5 px-6 rounded-lg transition-colors flex items-center gap-2">
                                    <span class="material-symbols-outlined">save</span>
                                    Save Configuration
                                </button>
                            </div>
                        </div>
                    </section>

                </div>
            </main>
        </div>

        <!-- ======================= DESIGN MODE ======================= -->
        <div id="design-mode-app" class="absolute inset-0 flex flex-1 hidden fade-in">
            <aside class="w-20 lg:w-64 bg-panel-dark border-r border-border-dark flex flex-col glass-panel z-10">
                <div class="p-4 flex flex-col gap-6">
                    <div class="hidden lg:flex gap-3 items-center">
                        <div class="bg-primary/20 p-2 rounded-lg text-primary">
                            <span class="material-symbols-outlined">edit_square</span>
                        </div>
                        <div class="flex flex-col">
                            <h1 class="text-white text-sm font-semibold leading-tight">Design Mode</h1>
                            <p class="text-[#9ca6ba] text-xs font-normal">Active Editor</p>
                        </div>
                    </div>
                    <div class="flex flex-col gap-1">
                        <div onclick="openAIAssistant()"
                            class="flex items-center gap-3 px-3 py-3 rounded-lg bg-gradient-to-r from-indigo-500/20 to-purple-500/20 border border-indigo-500/30 text-indigo-400 cursor-pointer hover:text-white hover:border-indigo-400 transition-all group mb-1">
                            <span class="material-symbols-outlined animate-pulse">auto_awesome</span>
                            <p
                                class="hidden lg:block text-sm font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-purple-400 group-hover:text-white group-hover:bg-none">
                                AI Assistant</p>
                        </div>
                        <div onclick="openTemplates()"
                            class="flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-white/5 cursor-pointer text-[#9ca6ba] hover:text-white group transition-colors">
                            <span class="material-symbols-outlined">dashboard_customize</span>
                            <p class="hidden lg:block text-sm font-medium">Templates</p>
                        </div>
                        <div onclick="alert('Elements library coming soon!')"
                            class="flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-white/5 cursor-pointer text-[#9ca6ba] hover:text-white transition-colors">
                            <span class="material-symbols-outlined fill-current">category</span>
                            <p class="hidden lg:block text-sm font-medium">Elements</p>
                        </div>
                        <div onclick="document.getElementById('model-text').focus()"
                            class="flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-white/5 cursor-pointer text-[#9ca6ba] hover:text-white transition-colors">
                            <span class="material-symbols-outlined">title</span>
                            <p class="hidden lg:block text-sm font-medium">Text</p>
                        </div>
                        <div onclick="openGraphics()"
                            class="flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-white/5 cursor-pointer text-[#9ca6ba] hover:text-white transition-colors">
                            <span class="material-symbols-outlined">image</span>
                            <p class="hidden lg:block text-sm font-medium">Graphics</p>
                        </div>
                        <div onclick="openPromotionsManager()"
                            class="flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-white/5 cursor-pointer text-green-400 hover:text-white transition-colors border border-green-500/20">
                            <span class="material-symbols-outlined">campaign</span>
                            <p class="hidden lg:block text-sm font-bold">Active Promos</p>
                        </div>
                        <div onclick="openSpinWheelCreator()"
                            class="flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-white/5 cursor-pointer text-orange-400 hover:text-white transition-colors border border-orange-500/20">
                            <span class="material-symbols-outlined">toys</span>
                            <p class="hidden lg:block text-sm font-bold">Spin Wheel</p>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- CANVAS AREA -->
            <main class="flex-1 flex flex-col bg-background-light dark:bg-background-dark relative overflow-hidden">
                <div
                    class="flex items-center justify-between px-6 py-2 border-b border-border-dark bg-background-dark/50">
                    <div class="flex flex-wrap gap-2 items-center">
                        <span class="text-[#9ca6ba] text-xs font-medium">Promotions</span>
                        <span class="text-[#9ca6ba] text-xs">/</span>
                        <span class="text-white text-xs font-medium bg-slate-800 px-2 py-0.5 rounded">Summer Sale
                            2024</span>
                    </div>
                    <div class="flex gap-2">
                        <button
                            class="bg-primary hover:bg-blue-600 text-white text-xs font-bold px-4 py-1.5 rounded transition-colors flex items-center gap-2"
                            onclick="deployPromotion()">
                            <span class="material-symbols-outlined text-[16px]">rocket_launch</span>
                            Deploy
                        </button>
                        <div class="w-px h-6 bg-[#282e39] mx-1"></div>
                        <button class="p-1.5 rounded hover:bg-white/10 text-[#9ca6ba] hover:text-white">
                            <span class="material-symbols-outlined text-[20px]">undo</span>
                        </button>
                        <button class="p-1.5 rounded hover:bg-white/10 text-[#9ca6ba] hover:text-white">
                            <span class="material-symbols-outlined text-[20px]">redo</span>
                        </button>
                    </div>
                </div>

                <div class="flex-1 canvas-bg flex items-center justify-center p-8 overflow-auto">
                    <!-- MOCK CANVAS -->
                    <div
                        class="w-[800px] h-[480px] bg-white rounded shadow-2xl relative flex overflow-hidden ring-4 ring-primary/20 scale-75 lg:scale-100 origin-center transition-transform">
                        <div id="design-canvas-bg" class="absolute inset-0 bg-cover bg-center"
                            style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuBSOGf4Vm8zvhPyzdwVhUPo05LPP36PFUEB3SZVDuTYJE5iK58KKvTrsWEM0MjoKWBKz4xjBbVkohZg_Z5x-9etNg-_U1TWAWv0pDR-gI99fHq2Y8I-2uyNcl2qORZuu6BjYLvGlZXobnFz8WnjleQbLdJLeKyysAWs8d_7mCV22Vk-0cYk257EG48bsAHfJT1j0gI5yh7ILTTpchLOB2EbO17HueFWiMbRIyiJLCFPJtkmUxbxb5lvfti7OpUVzQrua2rPrlR5QGQ')">
                            <div class="absolute inset-0 bg-gradient-to-r from-black/80 via-black/40 to-transparent">
                            </div>
                        </div>
                        <div class="relative z-10 p-12 flex flex-col justify-center text-white max-w-lg">
                            <h1 id="design-canvas-heading" class="text-6xl font-black mb-4 leading-tight italic">
                                FRESH<br /><span class="text-primary">DEALS</span></h1>
                            <p id="design-canvas-subtext" class="text-xl mb-8 font-medium text-slate-200">Get up to 40%
                                OFF on all seasonal organic
                                vegetables today.</p>
                            <div class="bg-white text-black font-bold px-6 py-3 rounded text-lg w-max">ADD TO BASKET
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ZOOM CONTROLS -->
                <div
                    class="absolute bottom-6 left-1/2 -translate-x-1/2 flex items-center gap-4 bg-background-dark/90 backdrop-blur-md px-4 py-2 rounded-full border border-border-dark shadow-2xl">
                    <button
                        class="flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium text-white hover:bg-white/10">
                        <span class="material-symbols-outlined text-[18px]">remove</span>
                    </button>
                    <span class="text-xs font-bold text-white min-w-[40px] text-center">100%</span>
                    <button
                        class="flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium text-white hover:bg-white/10">
                        <span class="material-symbols-outlined text-[18px]">add</span>
                    </button>
                </div>
            </main>

            <!-- PROPERTIES PANEL -->
            <aside class="w-72 bg-panel-dark border-l border-border-dark flex flex-col glass-panel z-10">
                <div class="p-4 border-b border-border-dark">
                    <h3 class="text-white text-sm font-bold tracking-tight">Properties</h3>
                </div>
                <div class="p-4 space-y-6">
                    <div class="space-y-3">
                        <label class="text-[#9ca6ba] text-[10px] uppercase font-bold tracking-widest">Main Text</label>
                        <textarea id="model-text"
                            class="w-full bg-slate-800 border-border-dark text-white text-xs rounded-lg p-2" rows="3"
                            oninput="updateCanvas()">FRESH<br/><span class="text-primary">DEALS</span></textarea>
                    </div>
                    <div class="space-y-3">
                        <label class="text-[#9ca6ba] text-[10px] uppercase font-bold tracking-widest">Sub Text</label>
                        <textarea id="model-subtext"
                            class="w-full bg-slate-800 border-border-dark text-white text-xs rounded-lg p-2" rows="3"
                            oninput="updateCanvas()">Get up to 40% OFF on all seasonal organic vegetables today.</textarea>
                    </div>
                    <div class="space-y-3">
                        <label class="text-[#9ca6ba] text-[10px] uppercase font-bold tracking-widest">Background Image
                            URL</label>
                        <input id="model-image"
                            class="w-full bg-slate-800 border-border-dark text-white text-xs rounded-lg p-2" type="text"
                            value="" oninput="updateCanvas()" placeholder="https://..." />
                    </div>
                </div>
            </aside>
        </div>

    </div>

    <!-- Edit Modal (Moved to root level) -->
    <div id="editModal" class="fixed inset-0 bg-black/60 hidden items-center justify-center z-[100] backdrop-blur-sm">
        <div class="bg-[#1b212c] p-8 rounded-2xl w-full max-w-md border border-[#282e39] shadow-2xl relative">
            <span
                class="absolute top-4 right-4 text-[#9ca6ba] hover:text-white cursor-pointer material-symbols-outlined"
                onclick="document.getElementById('editModal').style.display='none'">close</span>
            <h2 class="text-xl font-bold mb-6 text-white border-b border-[#282e39] pb-2">Edit Product</h2>
            <input type="hidden" id="editId">

            <div class="space-y-4">
                <div><label class="text-xs text-[#9ca6ba]">Price</label><input type="number" id="editPrice" step="0.01"
                        class="w-full bg-background-dark border border-[#282e39] rounded text-white p-2"></div>
                <div><label class="text-xs text-[#9ca6ba]">Stock</label><input type="number" id="editStock"
                        class="w-full bg-background-dark border border-[#282e39] rounded text-white p-2"></div>
                <div><label class="text-xs text-[#9ca6ba]">Discount %</label><input type="number" id="editDiscount"
                        class="w-full bg-background-dark border border-[#282e39] rounded text-white p-2"></div>
                <div><label class="text-xs text-[#9ca6ba]">Promo Text</label><input type="text" id="editPromoDesc"
                        class="w-full bg-background-dark border border-[#282e39] rounded text-white p-2"></div>
                <div><label class="text-xs text-[#9ca6ba]">Expiry</label><input type="date" id="editPromoExpiry"
                        class="w-full bg-background-dark border border-[#282e39] rounded text-white p-2"></div>
                <div><label class="text-xs text-[#9ca6ba]">Image</label><input type="text" id="editImage"
                        class="w-full bg-background-dark border border-[#282e39] rounded text-white p-2"></div>
            </div>

            <button onclick="saveEdit()"
                class="mt-6 w-full bg-primary py-2 rounded font-bold text-white hover:bg-blue-600">Save Changes</button>
        </div>
    </div>

    <!-- Tool Modal (Templates / Graphics) -->
    <div id="toolModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-[110] backdrop-blur-sm">
        <div class="bg-[#1b212c] p-6 rounded-2xl w-full max-w-3xl border border-[#282e39] shadow-2xl relative">
            <div class="flex items-center justify-between mb-4">
                <h2 id="toolModalTitle" class="text-lg font-bold text-white">Select Option</h2>
                <button type="button" onclick="closeToolModal()"
                    class="text-[#9ca6ba] hover:text-white transition-colors">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div id="toolModalContent" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"></div>
        </div>
    </div>
    <input id="localBackgroundImageInput" type="file" accept="image/*" class="hidden"
        onchange="handleLocalBackgroundImage(event)">

    <!-- AI Assistant Modal -->
    <div id="aiModal" class="fixed inset-0 bg-black/80 hidden items-center justify-center z-[120] backdrop-blur-md">
        <div
            class="bg-[#1b212c] p-8 rounded-2xl w-full max-w-lg border border-indigo-500/30 shadow-2xl relative overflow-hidden">
            <!-- Glow Effect -->
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500">
            </div>

            <span
                class="absolute top-4 right-4 text-[#9ca6ba] hover:text-white cursor-pointer material-symbols-outlined"
                onclick="document.getElementById('aiModal').style.display='none'">close</span>

            <div class="flex items-center gap-3 mb-6">
                <div class="p-2 bg-indigo-500/20 rounded-lg text-indigo-400">
                    <span class="material-symbols-outlined">auto_awesome</span>
                </div>
                <h2 class="text-xl font-bold text-white">AI Design Assistant</h2>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="text-[#9ca6ba] text-xs uppercase font-bold tracking-widest mb-2 block">Describe your
                        promotion</label>
                    <textarea id="ai-prompt"
                        class="w-full bg-slate-800 border-slate-700 focus:border-indigo-500 text-white rounded-xl p-4 transition-all"
                        rows="3"
                        placeholder="e.g., Summer sale on fresh organic strawberries with 20% discount..."></textarea>
                </div>

                <!-- Suggestions -->
                <div class="flex flex-wrap gap-2">
                    <button onclick="setPrompt('Halloween candy special offer')"
                        class="text-xs bg-slate-800 hover:bg-slate-700 text-slate-300 px-3 py-1.5 rounded-full transition-colors border border-slate-700">ðŸŽƒ
                        Halloween Sale</button>
                    <button onclick="setPrompt('Big electronics clearance sale 50% off')"
                        class="text-xs bg-slate-800 hover:bg-slate-700 text-slate-300 px-3 py-1.5 rounded-full transition-colors border border-slate-700">âš¡
                        Flash Deal</button>
                    <button onclick="setPrompt('Organic vegetables fresh from farm')"
                        class="text-xs bg-slate-800 hover:bg-slate-700 text-slate-300 px-3 py-1.5 rounded-full transition-colors border border-slate-700">ðŸ¥—
                        Fresh Food</button>
                </div>

                <div id="ai-error"
                    class="hidden bg-red-500/10 border border-red-500/20 text-red-400 text-sm p-3 rounded-lg"></div>

                <button onclick="generateDesign()" id="ai-gen-btn"
                    class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-3 rounded-xl shadow-lg shadow-indigo-500/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined">magic_button</span>
                    Generate Design
                </button>
            </div>
        </div>
    </div>

    <!-- Promotions Manager Modal -->
    <div id="promotionsManagerModal"
        class="fixed inset-0 bg-black/80 hidden items-center justify-center z-[130] backdrop-blur-md">
        <div
            class="bg-[#1b212c] p-8 rounded-2xl w-full max-w-4xl border border-green-500/30 shadow-2xl relative overflow-hidden flex flex-col max-h-[90vh]">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-green-500 to-emerald-400"></div>

            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center gap-3">
                    <div class="p-2 bg-green-500/20 rounded-lg text-green-400">
                        <span class="material-symbols-outlined">campaign</span>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-white">Active Promotions</h2>
                        <div class="flex items-center gap-2">
                            <p class="text-xs text-[#9ca6ba]">Ads rotate every 30 minutes on customer display.</p>
                            <span class="text-[10px] bg-green-500/10 text-green-400 px-2 py-1 rounded-full font-mono"
                                id="rotation-timer">--:--</span>
                        </div>
                    </div>
                </div>
                <button onclick="document.getElementById('promotionsManagerModal').style.display='none'"
                    class="text-[#9ca6ba] hover:text-white transition-colors">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <div class="flex-1 overflow-y-auto pr-2 space-y-4" id="promotionsList">
                <!-- Injected via JS -->
                <div class="text-center py-12 text-[#9ca6ba]">Loading...</div>
            </div>

            <div class="mt-6 pt-4 border-t border-[#282e39] flex justify-end">
                <button onclick="document.getElementById('promotionsManagerModal').style.display='none'"
                    class="text-[#9ca6ba] hover:text-white px-4 py-2 mr-2">Close</button>
            </div>
        </div>
    </div>

    <!-- Spin Wheel Creator Modal -->
    <div id="spinWheelCreatorModal"
        class="fixed inset-0 bg-black/80 hidden items-center justify-center z-[130] backdrop-blur-md">
        <div
            class="bg-[#1b212c] p-8 rounded-2xl w-full max-w-lg border border-orange-500/30 shadow-2xl relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-orange-500 to-yellow-400"></div>

            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center gap-3">
                    <div class="p-2 bg-orange-500/20 rounded-lg text-orange-400">
                        <span class="material-symbols-outlined">toys</span>
                    </div>
                    <h2 class="text-xl font-bold text-white">Create Spin Wheel Offer</h2>
                </div>
                <button onclick="document.getElementById('spinWheelCreatorModal').style.display='none'"
                    class="text-[#9ca6ba] hover:text-white transition-colors">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-[#9ca6ba] mb-1">Campaign Title</label>
                    <input type="text" id="wheel-title"
                        class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-3 focus:ring-orange-500 focus:border-orange-500"
                        placeholder="e.g. Weekend Flash Win">
                </div>

                <div class="space-y-4">
                    <label class="block text-sm font-medium text-[#9ca6ba]">Prizes (Comma Separated)</label>
                    <textarea id="wheel-prizes" rows="3"
                        class="w-full bg-background-dark border border-[#282e39] rounded-lg text-white px-4 py-3 focus:ring-orange-500 focus:border-orange-500 text-sm"
                        placeholder="10% OFF, 5% OFF, Free Item, Better Luck Next Time"></textarea>
                    <p class="text-xs text-[#9ca6ba]">Enter at least 4 prizes.</p>
                </div>

                <button onclick="deploySpinWheel()" id="btn-deploy-wheel"
                    class="w-full mt-4 bg-gradient-to-r from-orange-500 to-yellow-500 hover:from-orange-600 hover:to-yellow-600 text-white font-bold py-3 rounded-xl shadow-lg shadow-orange-500/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined">rocket_launch</span>
                    Launch Campaign
                </button>
            </div>
        </div>
    </div>

    <script src="/worker-frontend/static/worker.js"></script>
</body>

</html>